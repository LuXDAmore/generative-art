(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{481:function(e,n){},482:function(e,n){},508:function(e,n){},550:function(e,n,t){"use strict";t.r(n);t(21),t(7),t(23);var r=t(2),o=t(547),d=(t(546),t(545),t(208)),c={name:"facemesh-with-machine-learning",data:()=>({sketchManager:null,facemesh:null}),mounted(){var e=this;return Object(r.a)((function*(){try{e.sketchManager=yield e.$sketch({animate:!0,duration:6.279582609797744,context:"webgl",attributes:{antialias:!0},canvas:e.$refs.canvas},e.sketch)}catch(e){console.error(e)}}))()},beforeDestroy(){this.sketchManager&&this.sketchManager.unload()},methods:{sketch(e){var n=this;return Object(r.a)((function*(){var{context:c,width:l,height:v}=e,f=new d.H({context:c,antialias:!0,alpha:!0});f.setClearColor(new d.f("#333"),1),f.physicallyCorrectLights=!0,f.outputEncoding=d.I;var h=new d.r(92,l/v,.01);h.position.set(0,0,250),h.lookAt(new d.E(1,1,1));var{OrbitControls:m}=yield t.e(1).then(t.bind(null,549)).then(e=>e.default||e),y=new m(h,c.canvas),w=new d.x,x=new d.s(100,100),P=new d.p({color:new d.f("#123"),side:d.i}),_=new d.e,$=new d.y({vertexShader:"#define GLSLIFY 1\n// VSCode vertex\n#pragma vscode_glsllint_stage : vert\n\n// Varying\nvarying vec3 vPos;\n\n// Main\nvoid main () {\n\n    vPos = position.xyz;\n\n   vec4 mvPosition = modelViewMatrix * vec4( position.xyz, 1.0 );\n\n    gl_PointSize = 600. * ( 1. / - mvPosition.z );\n\n    gl_Position = projectionMatrix * mvPosition;\n\n}\n",fragmentShader:"#define GLSLIFY 1\n// VSCode Frag\n#pragma vscode_glsllint_stage : frag\n\n// Const\nconst float PI = 3.1415926535897932384626433832795;\n\n// Uniforms\nuniform mediump float uPlayhead;\nuniform sampler2D pointTexture;\n\n// Varying\nvarying vec3 vPos;\n\n// Main\nvoid main () {\n\n    gl_FragColor = vec4( gl_PointCoord, 1., 1. ) * vec4( vPos, 1. );\n\n}\n",extensions:{derivatives:"#extension GL_OES_standard_derivatives : enable"},depthTest:!1,depthWrite:!1,transparent:!0,side:d.i,uniforms:{uPlayhead:{type:"f",value:0}}}),k=new d.t(_,$),C=new d.o(x,P),M=new d.l(new Array(1404).fill(0),3).setUsage(d.j);if(x.name="face",M.name="position",_.setAttribute("position",M),w.add(k),w.add(C),n.$refs.video){var j=function(){var e=Object(r.a)((function*(){if(n.facemesh){var e=yield n.facemesh.estimateFaces(n.$refs.video);e.length&&e.forEach(e=>{e.mesh&&(e.mesh.forEach((e,n)=>{var[t,r,o]=e;return M.setXYZ(n,t,r,o)}),_.attributes.position.needsUpdate=!0,console.info("Face updated",{pointsGeometry:_}))})}}));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(r.a)((function*(){n.facemesh=yield o.a({maxFaces:1}),yield j()}));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(r.a)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v;try{if(!n.$refs.video)return;var r=l/3,o=v/3;n.$refs.video.width=r,n.$refs.video.height=o,n.$refs.video.srcObject=yield navigator.mediaDevices.getUserMedia({audio:!1,video:{width:e,height:t,facingMode:"user"}}),yield O(),yield n.$refs.video.play()}catch(e){console.error(e)}}));return function(){return e.apply(this,arguments)}}();return n.$refs.video.addEventListener("click",j,!1),n.$refs.video.addEventListener("playing",j,!1),{render(e){var{playhead:n}=e;$.uniforms.uPlayhead.value=n,y.update(),f.render(w,h)},resize(e){var{pixelRatio:n,viewportWidth:t,viewportHeight:r}=e;f.setSize(t,r,!1),f.setPixelRatio(n),h.aspect=r/r,h.updateProjectionMatrix(),S()},unload(){y.dispose(),f.dispose()}}}}))()}}},l=t(32),component=Object(l.a)(c,(function(){var e=this.$createElement,n=this._self._c||e;return n("main",{staticClass:"container canvas-container"},[n("canvas",{ref:"canvas"}),n("video",{ref:"video",staticClass:"absolute z-index--1 pin-r pin-b cursor--pointer",attrs:{preload:"auto",playsinline:"",autoplay:"",muted:""},domProps:{muted:!0}})])}),[],!1,null,null,null);n.default=component.exports}}]);